<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>11.2.&nbsp;WAL splitting</title><link rel="stylesheet" href="css/freebsd_docbook.css" type="text/css"><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="book.html" title="The Apache HBase Book"><link rel="up" href="wal.html" title="Chapter&nbsp;11.&nbsp;The WAL"><link rel="prev" href="wal.html" title="Chapter&nbsp;11.&nbsp;The WAL"><link rel="next" href="blooms.html" title="Chapter&nbsp;12.&nbsp;Bloom Filters"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">11.2.&nbsp;WAL splitting</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="wal.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;11.&nbsp;The WAL</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="blooms.html">Next</a></td></tr></table><hr></div><div class="section" title="11.2.&nbsp;WAL splitting"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wal_splitting"></a>11.2.&nbsp;WAL splitting</h2></div><div><h3 class="subtitle">How edits are recovered from a crashed RegionServer</h3></div></div></div><p>When a RegionServer crashes, it will lose its ephemeral lease in
      ZooKeeper...TODO</p><div class="section" title="11.2.1.&nbsp;hbase.hlog.split.skip.errors"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2512"></a>11.2.1.&nbsp;<code class="varname">hbase.hlog.split.skip.errors</code></h3></div></div></div><p>When set to <code class="constant">true</code>, the default, any error
        encountered splitting will be logged, the problematic WAL will be
        moved into the <code class="filename">.corrupt</code> directory under the hbase
        <code class="varname">rootdir</code>, and processing will continue. If set to
        <code class="constant">false</code>, the exception will be propagated and the
        split logged as failed.<sup>[<a name="d0e2530" href="#ftn.d0e2530" class="footnote">16</a>]</sup></p></div><div class="section" title="11.2.2.&nbsp;How EOFExceptions are treated when splitting a crashed RegionServers' WALs"><div class="titlepage"><div><div><h3 class="title"><a name="d0e2536"></a>11.2.2.&nbsp;How EOFExceptions are treated when splitting a crashed
        RegionServers' WALs</h3></div></div></div><p>If we get an EOF while splitting logs, we proceed with the split
        even when <code class="varname">hbase.hlog.split.skip.errors</code> ==
        <code class="constant">false</code>. An EOF while reading the last log in the
        set of files to split is near-guaranteed since the RegionServer likely
        crashed mid-write of a record. But we'll continue even if we got an
        EOF reading other than the last file in the set.<sup>[<a name="d0e2547" href="#ftn.d0e2547" class="footnote">17</a>]</sup></p></div><div class="footnotes"><br><hr width="100" align="left"><div class="footnote"><p><sup>[<a name="ftn.d0e2530" href="#d0e2530" class="para">16</a>] </sup>See <a class="link" href="https://issues.apache.org/jira/browse/HBASE-2958" target="_top">HBASE-2958
            When hbase.hlog.split.skip.errors is set to false, we fail the
            split but thats it</a>. We need to do more than just fail split
            if this flag is set.</p></div><div class="footnote"><p><sup>[<a name="ftn.d0e2547" href="#d0e2547" class="para">17</a>] </sup>For background, see <a class="link" href="https://issues.apache.org/jira/browse/HBASE-2643" target="_top">HBASE-2643
            Figure how to deal with eof splitting logs</a></p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="wal.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="wal.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="blooms.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;11.&nbsp;The WAL&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="book.html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;12.&nbsp;Bloom Filters</td></tr></table></div></body></html>